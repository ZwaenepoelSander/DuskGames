/*
Copyright (c) 2024 Dusk
All rights reserved.

This code is proprietary to Dusk AI Inc.
The code may be used solely for accessing the Service provided by Dusk AI Inc. following the Dusk Terms of Service ("Terms") accessible at dusk.gg/eula. You may not use this code for any use or purpose other than as expressly permitted by the Terms.
Restrictions set forth in the Terms include, but is not limited to, that you may not copy, adapt, modify, prepare derivative works based upon, distribute, license, sell, transfer, publicly display, publicly perform, transmit, stream, broadcast, attempt to discover any source code, reverse engineer, decompile, dissemble, or otherwise exploit the code as a whole or any portion of the code.
*/
!function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=i(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function u(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function l(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}var c=function e(t){var r=t,i={}.toString.call(t).slice(8,-1);if("Set"==i)return new Set(n(t).map((function(t){return e(t)})));if("Map"==i)return new Map(n(t).map((function(t){return[e(t[0]),e(t[1])]})));if("Date"==i)return new Date(t.getTime());if("RegExp"==i)return RegExp(t.source,function(e){if("string"==typeof e.source.flags)return e.source.flags;var t=[];return e.global&&t.push("g"),e.ignoreCase&&t.push("i"),e.multiline&&t.push("m"),e.sticky&&t.push("y"),e.unicode&&t.push("u"),t.join("")}(t));if("Array"==i||"Object"==i)for(var o in r=Array.isArray(t)?[]:{},t)r[o]=e(t[o]);return r};var f="".concat("DUSK","_INVALID_ACTION");var p=["acos","acosh","asin","asinh","atan","atan2","atanh","cbrt","cos","cosh","exp","expm1","hypot","log","log10","log1p","log2","pow","sin","sinh","sqrt","tan"];var d,h=new Map;function v(e){var t=h.get(e);if(!t)throw new Error("[GAMES_SDK][ROOM_GAME_STATE_MISSING]");return t}function y(e,t){h.set(e,t)}function g(e){h.delete(e)}var w="remove",b="replace",m="add",S=Symbol.for("__MUTATIVE_PROXY_DRAFT__"),E=Symbol("__MUTATIVE_RAW_RETURN_SYMBOL__"),O=Symbol.iterator,M={mutable:"mutable",immutable:"immutable"},A={};function T(e){var t;return null!==(t=e.copy)&&void 0!==t?t:e.original}function U(e){return!!P(e)}function P(t){return"object"!==e(t)?null:null==t?void 0:t[S]}function I(e){var t,r=P(e);return r?null!==(t=r.copy)&&void 0!==t?t:r.original:e}function _(t,r){return!(!t||"object"!==e(t))&&(Object.getPrototypeOf(t)===Object.prototype||Array.isArray(t)||t instanceof Map||t instanceof Set||!!(null==r?void 0:r.mark)&&((n=r.mark(t,M))===M.immutable||"function"==typeof n));var n}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(Object.hasOwnProperty.call(e,"key")){var r=P(x(e.parent.copy,e.key));if(null!==r&&(null==r?void 0:r.original)!==e.original)return null;t.push(3===e.parent.type?Array.from(e.parent.setMap.keys()).indexOf(e.key):e.key)}return e.parent?D(e.parent,t):t.reverse()}function j(e){return Array.isArray(e)?1:e instanceof Map?2:e instanceof Set?3:0}function x(e,t){return 2===j(e)?e.get(t):e[t]}function k(e,t,r){2===j(e)?e.set(t,r):e[t]=r}function C(e,t){var r=P(e);return(r?T(r):e)[t]}function z(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function R(e){if(e)for(;e.finalities.revoke.length>0;){e.finalities.revoke.pop()()}}function N(e,t){return t?e:[""].concat(e).map((function(e){var t="".concat(e);return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")})).join("/")}var B=Object.prototype.propertyIsEnumerable;function L(t,r){var n;if(Array.isArray(t))return Array.prototype.concat.call(t);if(t instanceof Set)return new Set(t.values());if(t instanceof Map)return new Map(t);if((null==r?void 0:r.mark)&&void 0!==(n=r.mark(t,M))&&n!==M.mutable){if(n===M.immutable)return function(e){var t=Object.create(Object.getPrototypeOf(e));return Reflect.ownKeys(e).forEach((function(r){var n=Reflect.getOwnPropertyDescriptor(e,r);n.enumerable&&n.configurable&&n.writable?t[r]=e[r]:(n.writable||(n.writable=!0,n.configurable=!0),(n.get||n.set)&&(n={configurable:!0,writable:!0,enumerable:n.enumerable,value:e[r]}),Reflect.defineProperty(t,r,n))})),t}(t);if("function"==typeof n){if(r.enablePatches||r.enableAutoFreeze)throw new Error("You can't use mark and patches or auto freeze together.");return n()}throw new Error("Unsupported mark result: ".concat(n))}if("object"===e(t)&&Object.getPrototypeOf(t)===Object.prototype){var i={};return Object.keys(t).forEach((function(e){i[e]=t[e]})),Object.getOwnPropertySymbols(t).forEach((function(e){B.call(t,e)&&(i[e]=t[e])})),i}throw new Error("Please check mark() to ensure that it is a stable marker draftable function.")}function F(e){e.copy||(e.copy=L(e.original,e.options))}function V(e){if(!_(e))return I(e);if(Array.isArray(e))return e.map(V);if(e instanceof Map)return new Map(Array.from(e.entries()).map((function(e){var t=r(e,2);return[t[0],V(t[1])]})));if(e instanceof Set)return new Set(Array.from(e).map(V));var t=Object.create(Object.getPrototypeOf(e));for(var n in e)t[n]=V(e[n]);return t}function W(e){return U(e)?V(e):e}function K(e){var t;e.assignedMap=null!==(t=e.assignedMap)&&void 0!==t?t:new Map,e.operated||(e.operated=!0,e.parent&&K(e.parent))}function G(){throw new Error("Cannot modify frozen object")}function H(t,n,i,o,s){i=null!=i?i:new WeakMap,o=null!=o?o:[],s=null!=s?s:[];var u=i.has(t)?i.get(t):t;if(o.length>0){var l=o.indexOf(u);if(u&&"object"===e(u)&&-1!==l){if(o[0]===u)throw new Error("Forbids circular reference");throw new Error("Forbids circular reference: ~/".concat(s.slice(0,l).map((function(t,r){if("symbol"===e(t))return"[".concat(t.toString(),"]");var n=o[r];return"object"===e(t)&&(n instanceof Map||n instanceof Set)?Array.from(n.keys()).indexOf(t):t})).join("/")))}o.push(u),s.push(n)}else o.push(u);if(Object.isFrozen(t)||U(t))return o.pop(),void s.pop();switch(j(t)){case 2:var c,f=a(t);try{for(f.s();!(c=f.n()).done;){var p=r(c.value,2),d=p[0],h=p[1];H(d,d,i,o,s),H(h,d,i,o,s)}}catch(e){f.e(e)}finally{f.f()}t.set=t.clear=t.delete=G;break;case 3:var v,y=a(t);try{for(y.s();!(v=y.n()).done;){var g=v.value;H(g,g,i,o,s)}}catch(e){y.e(e)}finally{y.f()}t.add=t.clear=t.delete=G;break;case 1:Object.freeze(t);var w,b=0,m=a(t);try{for(m.s();!(w=m.n()).done;){H(w.value,b,i,o,s),b+=1}}catch(e){m.e(e)}finally{m.f()}break;default:Object.freeze(t),Object.keys(t).forEach((function(e){H(t[e],e,i,o,s)}))}o.pop(),s.pop()}function J(e,t){return e instanceof Map?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Y(e,t){if(t in e)for(var r=Reflect.getPrototypeOf(e);r;){var n=Reflect.getOwnPropertyDescriptor(r,t);if(n)return n;r=Reflect.getPrototypeOf(r)}}function X(e,t){var r=j(e);if(0===r)Reflect.ownKeys(e).forEach((function(r){t(r,e[r],e)}));else if(1===r){var n,i=0,o=a(e);try{for(o.s();!(n=o.n()).done;){var s=n.value;t(i,s,e),i+=1}}catch(e){o.e(e)}finally{o.f()}}else e.forEach((function(r,n){return t(n,r,e)}))}function q(e,t,r){if(!U(e)&&_(e,r)&&!t.has(e)&&!Object.isFrozen(e)){var n=e instanceof Set,i=n?new Map:void 0;if(t.add(e),X(e,(function(o,a){var s;if(U(a)){var u=P(a);F(u);var l=(null===(s=u.assignedMap)||void 0===s?void 0:s.size)||u.operated?u.copy:u.original;k(n?i:e,o,l)}else q(a,t,r)})),i){var o=e,a=Array.from(o);o.clear(),a.forEach((function(e){o.add(i.has(e)?i.get(e):e)}))}}}function $(e,t){var r=3===e.type?e.setMap:e.copy;e.finalities.revoke.length>1&&e.assignedMap.get(t)&&r&&q(x(r,t),e.finalities.handledSet,e.options)}function Q(e){3===e.type&&e.copy&&(e.copy.clear(),e.setMap.forEach((function(t){e.copy.add(I(t))})))}function Z(e,t,r,n){if(e.operated&&e.assignedMap&&e.assignedMap.size>0&&!e.finalized){if(r&&n){var i=D(e);i&&t(e,i,r,n)}e.finalized=!0}}function ee(e,t,r,n){var i=P(r);i&&(i.callbacks||(i.callbacks=[]),i.callbacks.push((function(o,a){var s,u=3===e.type?e.setMap:e.copy;if(z(x(u,t),r)){var l=i.original;i.copy&&(l=i.copy),Q(e),Z(e,n,o,a),e.options.enableAutoFreeze&&(e.options.updatedValues=null!==(s=e.options.updatedValues)&&void 0!==s?s:new WeakMap,e.options.updatedValues.set(l,i.original)),k(u,t,l)}})),e.options.enableAutoFreeze&&i.finalities!==e.finalities&&(e.options.enableAutoFreeze=!1)),_(r,e.options)&&e.finalities.draft.push((function(){z(x(3===e.type?e.setMap:e.copy,t),r)&&$(e,t)}))}function te(e,t,r,n){var i=e.options.enablePatches.pathAsArray,o=void 0===i||i;switch(e.type){case 0:case 2:return function(e,t,r,n,i){var o=e.original,a=e.copy;e.assignedMap.forEach((function(e,s){var u=x(o,s),l=W(x(a,s)),c=e?J(o,s)?b:m:w;if(!z(u,l)||c!==b){var f=N(t.concat(s),i);r.push(c===w?{op:c,path:f}:{op:c,path:f,value:l}),n.push(c===m?{op:w,path:f}:c===w?{op:m,path:f,value:u}:{op:b,path:f,value:u})}}))}(e,t,r,n,o);case 1:return function(e,t,r,n,i){var o=e.original,a=e.assignedMap,s=e.options,u=e.copy;if(u.length<o.length){var l=[u,o];o=l[0],u=l[1];var c=[n,r];r=c[0],n=c[1]}for(var f=0;f<o.length;f+=1)if(a.get(f.toString())&&u[f]!==o[f]){var p=N(t.concat([f]),i);r.push({op:b,path:p,value:W(u[f])}),n.push({op:b,path:p,value:W(o[f])})}for(var d=o.length;d<u.length;d+=1){var h=N(t.concat([d]),i);r.push({op:m,path:h,value:W(u[d])})}if(o.length<u.length){var v=s.enablePatches.arrayLengthAssignment;if(void 0===v||v){var y=N(t.concat(["length"]),i);n.push({op:b,path:y,value:o.length})}else for(var g=u.length;o.length<g;g-=1){var S=N(t.concat([g-1]),i);n.push({op:w,path:S})}}}(e,t,r,n,o);case 3:return function(e,t,r,n,i){var o=e.original,a=e.copy,s=0;o.forEach((function(e){if(!a.has(e)){var o=N(t.concat([s]),i);r.push({op:w,path:o,value:e}),n.unshift({op:m,path:o,value:e})}s+=1})),s=0,a.forEach((function(e){if(!o.has(e)){var a=N(t.concat([s]),i);r.push({op:m,path:a,value:e}),n.unshift({op:w,path:a,value:e})}s+=1}))}(e,t,r,n,o)}}var re=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("object"===e(t)&&null!==t&&(!_(t,r)||n))throw new Error("Strict mode: Mutable data cannot be accessed directly, please use 'unsafe(callback)' wrap.")},ne=t({get size(){return T(P(this)).size},has:function(e){return T(P(this)).has(e)},set:function(e,t){var r=P(this),n=T(r);return n.has(e)&&z(n.get(e),t)||(F(r),K(r),r.assignedMap.set(e,!0),r.copy.set(e,t),ee(r,e,t,te)),this},delete:function(e){if(!this.has(e))return!1;var t=P(this);return F(t),K(t),t.original.has(e)?t.assignedMap.set(e,!1):t.assignedMap.delete(e),t.copy.delete(e),!0},clear:function(){var e=P(this);if(this.size){F(e),K(e),e.assignedMap=new Map;var t,n=a(e.original);try{for(n.s();!(t=n.n()).done;){var i=r(t.value,1)[0];e.assignedMap.set(i,!1)}}catch(e){n.e(e)}finally{n.f()}e.copy.clear()}},forEach:function(e,t){var r=this;T(P(this)).forEach((function(n,i){e.call(t,r.get(i),i,r)}))},get:function(e){var t,r,n=P(this),i=T(n).get(e),o=(null===(r=(t=n.options).mark)||void 0===r?void 0:r.call(t,i,M))===M.mutable;if(n.options.strict&&re(i,n.options,o),o)return i;if(n.finalized||!_(i,n.options))return i;if(i!==n.original.get(e))return i;var a=A.createDraft({original:i,parentDraft:n,key:e,finalities:n.finalities,options:n.options});return F(n),n.copy.set(e,a),a},keys:function(){return T(P(this)).keys()},values:function(){var e,r=this,n=this.keys();return t(e={},O,(function(){return r.values()})),t(e,"next",(function(){var e=n.next();return e.done?e:{done:!1,value:r.get(e.value)}})),e},entries:function(){var e,r=this,n=this.keys();return t(e={},O,(function(){return r.entries()})),t(e,"next",(function(){var e=n.next();if(e.done)return e;var t=r.get(e.value);return{done:!1,value:[e.value,t]}})),e}},O,(function(){return this.entries()})),ie=Reflect.ownKeys(ne),oe=function(e,t,r){var n=r.isValuesIterator;return function(){var r,i,o=t.next();if(o.done)return o;var a=o.value,s=e.setMap.get(a),u=P(s),l=(null===(i=(r=e.options).mark)||void 0===i?void 0:i.call(r,s,M))===M.mutable;if(e.options.strict&&re(a,e.options,l),l||u||!_(a,e.options)||e.finalized||!e.original.has(a))u&&(s=u.proxy);else{var c=A.createDraft({original:a,parentDraft:e,key:a,finalities:e.finalities,options:e.options});e.setMap.set(a,c),s=c}return{done:!1,value:n?s:[s,s]}}},ae=(d={get size(){return P(this).setMap.size},has:function(e){var t=P(this);if(t.setMap.has(e))return!0;F(t);var r=P(e);return!(!r||!t.setMap.has(r.original))},add:function(e){var t=P(this);return this.has(e)||(F(t),K(t),t.assignedMap.set(e,!0),t.setMap.set(e,e),ee(t,e,e,te)),this},delete:function(e){if(!this.has(e))return!1;var t=P(this);F(t),K(t);var r=P(e);return r&&t.setMap.has(r.original)?(t.assignedMap.set(r.original,!1),t.setMap.delete(r.original)):(!r&&t.setMap.has(e)?t.assignedMap.set(e,!1):t.assignedMap.delete(e),t.setMap.delete(e))},clear:function(){if(this.size){var e=P(this);F(e),K(e);var t,r=a(e.original);try{for(r.s();!(t=r.n()).done;){var n=t.value;e.assignedMap.set(n,!1)}}catch(e){r.e(e)}finally{r.f()}e.setMap.clear()}},values:function(){var e,r=this,n=P(this);F(n);var i=n.setMap.keys();return t(e={},Symbol.iterator,(function(){return r.values()})),t(e,"next",oe(n,i,{isValuesIterator:!0})),e},entries:function(){var e,r=this,n=P(this);F(n);var i=n.setMap.keys();return t(e={},Symbol.iterator,(function(){return r.entries()})),t(e,"next",oe(n,i,{isValuesIterator:!1})),e},keys:function(){return this.values()}},t(d,O,(function(){return this.values()})),t(d,"forEach",(function(e,t){for(var r=this.values(),n=r.next();!n.done;)e.call(t,n.value,n.value,this),n=r.next()})),d),se=Reflect.ownKeys(ae),ue=new WeakSet,le={get:function(e,t,r){var n,i,o,a=null===(n=e.copy)||void 0===n?void 0:n[t];if(a&&ue.has(a))return a;if(t===S)return e;if(e.options.mark){var s="size"===t&&(e.original instanceof Map||e.original instanceof Set)?Reflect.get(e.original,t):Reflect.get(e.original,t,r);if((o=e.options.mark(s,M))===M.mutable)return e.options.strict&&re(s,e.options,!0),s}var u=T(e);if(u instanceof Map&&ie.includes(t)){if("size"===t)return Object.getOwnPropertyDescriptor(ne,"size").get.call(e.proxy);var l=ne[t];if(l)return l.bind(e.proxy)}if(u instanceof Set&&se.includes(t)){if("size"===t)return Object.getOwnPropertyDescriptor(ae,"size").get.call(e.proxy);var c=ae[t];if(c)return c.bind(e.proxy)}if(!J(u,t)){var f=Y(u,t);return f?"value"in f?f.value:null===(i=f.get)||void 0===i?void 0:i.call(e.proxy):void 0}var p=u[t];if(e.options.strict&&re(p,e.options),e.finalized||!_(p,e.options))return p;if(p===C(e.original,t)){if(F(e),e.copy[t]=ce({original:e.original[t],parentDraft:e,key:1===e.type?Number(t):t,finalities:e.finalities,options:e.options}),"function"==typeof o){var d=P(e.copy[t]);return F(d),K(d),d.copy}return e.copy[t]}return p},set:function(e,t,r){var n,i;if(3===e.type||2===e.type)throw new Error("Map/Set draft does not support any property assignment.");if(1===e.type&&"length"!==t&&(!(Number.isInteger(i=Number(t))&&i>=0)||0!==t&&0!==i&&String(i)!==String(t)))throw new Error("Only supports setting array indices and the 'length' property.");var o=Y(T(e),t);if(null==o?void 0:o.set)return o.set.call(e.proxy,r),!0;var a=C(T(e),t),s=P(a);return s&&z(s.original,r)?(e.copy[t]=r,e.assignedMap=null!==(n=e.assignedMap)&&void 0!==n?n:new Map,e.assignedMap.set(t,!1),!0):(z(r,a)&&(void 0!==r||J(e.original,t))||(F(e),K(e),J(e.original,t)&&z(r,e.original[t])?e.assignedMap.delete(t):e.assignedMap.set(t,!0),e.copy[t]=r,ee(e,t,r,te)),!0)},has:function(e,t){return t in T(e)},ownKeys:function(e){return Reflect.ownKeys(T(e))},getOwnPropertyDescriptor:function(e,t){var r=T(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.type||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},getPrototypeOf:function(e){return Reflect.getPrototypeOf(e.original)},setPrototypeOf:function(){throw new Error("Cannot call 'setPrototypeOf()' on drafts")},defineProperty:function(){throw new Error("Cannot call 'defineProperty()' on drafts")},deleteProperty:function(e,t){var r;return 1===e.type?le.set.call(this,e,t,void 0,e.proxy):(void 0!==C(e.original,t)||t in e.original?(F(e),K(e),e.assignedMap.set(t,!1)):(e.assignedMap=null!==(r=e.assignedMap)&&void 0!==r?r:new Map,e.assignedMap.delete(t)),e.copy&&delete e.copy[t],!0)}};function ce(e){var t=e.original,r=e.parentDraft,n=e.key,i=e.finalities,o=e.options,a=j(t),s={type:a,finalized:!1,parent:r,original:t,copy:null,proxy:null,finalities:i,options:o,setMap:3===a?new Map(t.entries()):void 0};(n||"key"in e)&&(s.key=n);var u=Proxy.revocable(1===a?Object.assign([],s):s,le),l=u.proxy,c=u.revoke;if(i.revoke.push(c),ue.add(l),s.proxy=l,r){var f=r;f.finalities.draft.push((function(e,t){var r,i,o=P(l),a=3===f.type?f.setMap:f.copy,s=x(a,n),u=P(s);if(u){var c=u.original;u.operated&&(c=I(s)),Q(u),Z(u,te,e,t),f.options.enableAutoFreeze&&(f.options.updatedValues=null!==(r=f.options.updatedValues)&&void 0!==r?r:new WeakMap,f.options.updatedValues.set(c,u.original)),k(a,n,c)}null===(i=o.callbacks)||void 0===i||i.forEach((function(r){r(e,t)}))}))}else{var p=P(l);p.finalities.draft.push((function(e,t){Q(p),Z(p,te,e,t)}))}return l}function fe(e,t,r,n,i){var o,a=P(e),s=null!==(o=null==a?void 0:a.original)&&void 0!==o?o:e,u=!!t.length;if(null==a?void 0:a.operated)for(;a.finalities.draft.length>0;){a.finalities.draft.pop()(r,n)}var l=u?t[0]:a?a.operated?a.copy:a.original:e;return a&&R(a),i&&H(l,l,null==a?void 0:a.options.updatedValues),[l,r&&u?[{op:b,path:[],value:t[0]}]:r,n&&u?[{op:b,path:[],value:s}]:n]}function pe(t){var r=t.rootDraft,n=t.value,i=t.useRawReturn,o=void 0!==i&&i,a=t.isRoot,s=void 0===a||a;X(n,(function(n,i,o){var a=P(i);if(a&&r&&a.finalities===r.finalities){t.isContainDraft=!0;var s=a.original;if(o instanceof Set){var u=Array.from(o);o.clear(),u.forEach((function(e){return o.add(n===e?s:e)}))}else k(o,n,s)}else"object"===e(i)&&null!==i&&(t.value=i,t.isRoot=!1,pe(t))})),s&&(t.isContainDraft||console.warn("The return value does not contain any draft, please use 'rawReturn()' to wrap the return value to improve performance."),o&&console.warn("The return value contains drafts, please don't use 'rawReturn()' to wrap the return value."))}function de(e){var t=P(e);if(!_(e,null==t?void 0:t.options))return e;var r,n=j(e);if(t&&!t.operated)return t.original;t&&(t.finalized=!0);try{r=2===n?new Map(e):3===n?Array.from(t.setMap.values()):L(e,null==t?void 0:t.options)}finally{t&&(t.finalized=!1)}return X(r,(function(e,n){t&&z(x(t.original,e),n)||k(r,e,de(n))})),3===n?new Set(r):r}function he(e){if(!U(e))throw new Error("current() is only used for Draft, parameter: ".concat(e));return de(e)}A.createDraft=ce;var ve=function(t){if(void 0!==t&&"[object Object]"!==Object.prototype.toString.call(t))throw new Error("Invalid options: ".concat(String(t),", 'options' should be an object."));return function n(i,o,s){var u,l,c;if("function"==typeof i&&"function"!=typeof o)return function(e){for(var t=this,r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return n(e,(function(e){return i.call.apply(i,[t,e].concat(a))}),o)};var f=i,p=o,d=s;if("function"!=typeof o&&(d=o),void 0!==d&&"[object Object]"!==Object.prototype.toString.call(d))throw new Error("Invalid options: ".concat(d,", 'options' should be an object."));d=Object.assign(Object.assign({},t),d);var h=U(f)?he(f):f,v=Array.isArray(d.mark)?function(e,t){var r,n=a(d.mark);try{for(n.s();!(r=n.n()).done;){var i=r.value;if("function"!=typeof i)throw new Error("Invalid mark: ".concat(i,", 'mark' should be a function."));var o=i(e,t);if(o)return o}}catch(e){n.e(e)}finally{n.f()}}:d.mark,y=null!==(u=d.enablePatches)&&void 0!==u&&u,g=null!==(l=d.strict)&&void 0!==l&&l,w={enableAutoFreeze:null!==(c=d.enableAutoFreeze)&&void 0!==c&&c,mark:v,strict:g,enablePatches:y};if(!_(h,w)&&"object"===e(h)&&null!==h)throw new Error("Invalid base state: create() only supports plain objects, arrays, Set, Map or using mark() to mark the state as immutable.");var b,m=function(e,t){var n,i,o,a={draft:[],revoke:[],handledSet:new WeakSet};t.enablePatches&&(i=[],o=[]);var s=(null===(n=t.mark)||void 0===n?void 0:n.call(t,e,M))!==M.mutable&&_(e,t)?ce({original:e,parentDraft:null,finalities:a,options:t}):e;return[s,function(){var e=r(fe(s,arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i,o,t.enableAutoFreeze),3),n=e[0],a=e[1],u=e[2];return t.enablePatches?[n,a,u]:n}]}(h,w),S=r(m,2),O=S[0],A=S[1];if("function"!=typeof o){if(!_(h,w))throw new Error("Invalid base state: create() only supports plain objects, arrays, Set, Map or using mark() to mark the state as immutable.");return[O,A]}try{b=p(O)}catch(e){throw R(P(O)),e}var T=function(t){var r=P(O);if(!U(t)){if(void 0!==t&&!z(t,O)&&(null==r?void 0:r.operated))throw new Error("Either the value is returned as a new non-draft value, or only the draft is modified without returning any value.");var n=null==t?void 0:t[E];if(n){var i=n[0];return w.strict&&"object"===e(t)&&null!==t&&pe({rootDraft:r,value:t,useRawReturn:!0}),A([i])}if(void 0!==t)return"object"===e(t)&&null!==t&&pe({rootDraft:r,value:t}),A([t])}if(t===O||void 0===t)return A([]);var o=P(t);if(w===o.options){if(o.operated)throw new Error("Cannot return a modified child draft.");return A([he(t)])}return A([t])};return b instanceof Promise?b.then(T,(function(e){throw R(P(O)),e})):T(b)}}();Object.prototype.constructor.toString();var ye={};Object.defineProperty(ye,"__esModule",{value:!0});var ge=ye.default=function t(r){if("object"!==e(r)||null===r)return r;if(Array.isArray(r))return r.map((function(r){return"object"!==e(r)||null===r?r:t(r)}));var n={};for(var i in r){var o=r[i];n[i]="object"!==e(o)||null===o?o:t(o)}return n};function we(e,t,r){if(!r){var n=ge(e);return t(n),n}return ve(e,t,{mark:function(){return"immutable"}})}function be(e){for(var t=Ee(this,e),r=0;r<this.length;r++)this[r]=t[r];return this}var me=function(e,t){if(void 0===e&&void 0===t)return 0;if(void 0===e)return 1;if(void 0===t)return-1;var r=Se(e),n=Se(t);return r<n?-1:r>n?1:0},Se=function(e){if(null===e)return"null";if("boolean"==typeof e||"number"==typeof e)return e.toString();if("string"==typeof e)return e;if("symbol"==typeof e)throw new TypeError;return e.toString()};function Ee(e,t){if(void 0===t&&(t=me),e.length<=1)return e;var r=Math.floor(e.length/2),n=e.slice(0,r),i=e.slice(r);return function(e,t,r){var n=[];for(;e.length&&t.length;)r(e[0],t[0])<=0?n.push(e.shift()):n.push(t.shift());return n.concat(e,t)}(Ee(n,t),Ee(i,t),t)}function Oe(e,t){var r,n=globalThis.Math.random;globalThis.Math.random=(r=e,function(){var e=r+=1831565813;return e=Math.imul(e^e>>>15,1|e),(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296});var i=globalThis.Array.prototype.sort;globalThis.Array.prototype.sort=be;try{return t()}finally{globalThis.Math.random=n,globalThis.Array.prototype.sort=i}}var Me,Ae,Te,Ue=4294967295;function Pe(e,t,r){var n=Math.floor(r/4294967296),i=r;e.setUint32(t,n),e.setUint32(t+4,i)}var Ie=("undefined"==typeof process||"never"!==(null===(Me=null===process||void 0===process?void 0:process.env)||void 0===Me?void 0:Me.TEXT_ENCODING))&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function _e(e){for(var t=e.length,r=0,n=0;n<t;){var i=e.charCodeAt(n++);if(0!=(4294967168&i))if(0==(4294965248&i))r+=2;else{if(i>=55296&&i<=56319&&n<t){var o=e.charCodeAt(n);56320==(64512&o)&&(++n,i=((1023&i)<<10)+(1023&o)+65536)}r+=0==(4294901760&i)?3:4}else r++}return r}var De=Ie?new TextEncoder:void 0,je=Ie?"undefined"!=typeof process&&"force"!==(null===(Ae=null===process||void 0===process?void 0:process.env)||void 0===Ae?void 0:Ae.TEXT_ENCODING)?200:0:Ue;var xe=(null==De?void 0:De.encodeInto)?function(e,t,r){De.encodeInto(e,t.subarray(r))}:function(e,t,r){t.set(De.encode(e),r)};Ie&&new TextDecoder,Ie&&"undefined"!=typeof process&&(null===(Te=null===process||void 0===process?void 0:process.env)||void 0===Te||Te.TEXT_DECODER);var ke,Ce=function(e,t){this.type=e,this.data=t},ze=(ke=function(e,t){return ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},ke(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ke(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Re=function(e){function t(r){var n=e.call(this,r)||this,i=Object.create(t.prototype);return Object.setPrototypeOf(n,i),Object.defineProperty(n,"name",{configurable:!0,enumerable:!1,value:t.name}),n}return ze(t,e),t}(Error);var Ne={type:-1,encode:function(e){var t,r,n,i;return e instanceof Date?function(e){var t,r=e.sec,n=e.nsec;if(r>=0&&n>=0&&r<=17179869183){if(0===n&&r<=4294967295){var i=new Uint8Array(4);return(t=new DataView(i.buffer)).setUint32(0,r),i}var o=r/4294967296,a=4294967295&r;return i=new Uint8Array(8),(t=new DataView(i.buffer)).setUint32(0,n<<2|3&o),t.setUint32(4,a),i}return i=new Uint8Array(12),(t=new DataView(i.buffer)).setUint32(0,n),Pe(t,4,r),i}((t=e.getTime(),r=Math.floor(t/1e3),n=1e6*(t-1e3*r),i=Math.floor(n/1e9),{sec:r+i,nsec:n-1e9*i})):null},decode:function(e){var t=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:n=t.getUint32(0),nsec:0};case 8:var r=t.getUint32(0);return{sec:n=4294967296*(3&r)+t.getUint32(4),nsec:r>>>2};case 12:var n=function(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}(t,4);return{sec:n,nsec:t.getUint32(0)};default:throw new Re("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}(e);return new Date(1e3*t.sec+t.nsec/1e6)}},Be=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(Ne)}return e.prototype.register=function(e){var t=e.type,r=e.encode,n=e.decode;if(t>=0)this.encoders[t]=r,this.decoders[t]=n;else{var i=1+t;this.builtInEncoders[i]=r,this.builtInDecoders[i]=n}},e.prototype.tryToEncode=function(e,t){for(var r=0;r<this.builtInEncoders.length;r++){if(null!=(n=this.builtInEncoders[r]))if(null!=(i=n(e,t)))return new Ce(-1-r,i)}for(r=0;r<this.encoders.length;r++){var n,i;if(null!=(n=this.encoders[r]))if(null!=(i=n(e,t)))return new Ce(r,i)}return e instanceof Ce?e:null},e.prototype.decode=function(e,t,r){var n=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return n?n(e,t,r):new Ce(t,e)},e.defaultCodec=new e,e}();var Le=function(){function t(e,t,r,n,i,o,a,s){void 0===e&&(e=Be.defaultCodec),void 0===t&&(t=void 0),void 0===r&&(r=100),void 0===n&&(n=2048),void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===a&&(a=!1),void 0===s&&(s=!1),this.extensionCodec=e,this.context=t,this.maxDepth=r,this.initialBufferSize=n,this.sortKeys=i,this.forceFloat32=o,this.ignoreUndefined=a,this.forceIntegerToFloat=s,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return t.prototype.reinitializeState=function(){this.pos=0},t.prototype.encodeSharedRef=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)},t.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)},t.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));null===e?this.encodeNil():void 0===e?this.encodeUndefined():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)},t.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},t.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),r=new Uint8Array(t),n=new DataView(t);r.set(this.bytes),this.view=n,this.bytes=r},t.prototype.encodeNil=function(){this.writeU8(192)},t.prototype.encodeUndefined=function(){this.writeU8(193)},t.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},t.prototype.encodeNumber=function(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},t.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: ".concat(e," bytes in UTF-8"));this.writeU8(219),this.writeU32(e)}},t.prototype.encodeString=function(e){if(e.length>je){var t=_e(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),xe(e,this.bytes,this.pos),this.pos+=t}else{t=_e(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,r){for(var n=e.length,i=r,o=0;o<n;){var a=e.charCodeAt(o++);if(0!=(4294967168&a)){if(0==(4294965248&a))t[i++]=a>>6&31|192;else{if(a>=55296&&a<=56319&&o<n){var s=e.charCodeAt(o);56320==(64512&s)&&(++o,a=((1023&a)<<10)+(1023&s)+65536)}0==(4294901760&a)?(t[i++]=a>>12&15|224,t[i++]=a>>6&63|128):(t[i++]=a>>18&7|240,t[i++]=a>>12&63|128,t[i++]=a>>6&63|128)}t[i++]=63&a|128}else t[i++]=a}}(e,this.bytes,this.pos),this.pos+=t}},t.prototype.encodeObject=function(t,r){var n=this.extensionCodec.tryToEncode(t,this.context);if(null!=n)this.encodeExtension(n);else if(Array.isArray(t))this.encodeArray(t,r);else if(ArrayBuffer.isView(t))this.encodeBinary(t);else{if("object"!==e(t))throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(t)));this.encodeMap(t,r)}},t.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: ".concat(t));this.writeU8(198),this.writeU32(t)}var r,n=(r=e)instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?new Uint8Array(r):Uint8Array.from(r);this.writeU8a(n)},t.prototype.encodeArray=function(e,t){var r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else{if(!(r<4294967296))throw new Error("Too large array: ".concat(r));this.writeU8(221),this.writeU32(r)}for(var n=0,i=e;n<i.length;n++){var o=i[n];this.doEncode(o,t+1)}},t.prototype.countWithoutUndefined=function(e,t){for(var r=0,n=0,i=t;n<i.length;n++){void 0!==e[i[n]]&&r++}return r},t.prototype.encodeMap=function(e,t){var r=Object.keys(e);this.sortKeys&&r.sort();var n=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(n<16)this.writeU8(128+n);else if(n<65536)this.writeU8(222),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large map object: ".concat(n));this.writeU8(223),this.writeU32(n)}for(var i=0,o=r;i<o.length;i++){var a=o[i],s=e[a];this.ignoreUndefined&&void 0===s||(this.encodeString(a),this.doEncode(s,t+1))}},t.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: ".concat(t));this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},t.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},t.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},t.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},t.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},t.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},t.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},t.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},t.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},t.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},t.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,r){var n=r/4294967296,i=r;e.setUint32(t,n),e.setUint32(t+4,i)}(this.view,this.pos,e),this.pos+=8},t.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),Pe(this.view,this.pos,e),this.pos+=8},t}(),Fe={};function Ve(e,t){var r;return void 0===t&&(t={}),function(e,t){return void 0===t&&(t=Fe),new Le(t.extensionCodec,t.context,t.maxDepth,t.initialBufferSize,t.sortKeys,t.forceFloat32,t.ignoreUndefined,t.forceIntegerToFloat).encodeSharedRef(e)}(e,{maxDepth:25,sortKeys:null!==(r=t.sortKeys)&&void 0!==r&&r})}function We(e){for(var t=Ve(e,{sortKeys:!0}),r=0,n=0;n<t.length;n++)r+=t[n];return r}function Ke(e,t){var r=new Error("[GAMES_SDK][".concat(e,"]"));return t&&(r.extraLoggingData=t),r}function Ge(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}function He(e,t){if(!e.persisted)throw Ke("PERSISTED_KEY_MISSING");if(!Ge(e.persisted))throw Ke("PERSISTED_NOT_AN_OBJECT");t.forEach((function(t){if(!e.persisted[t])throw Ke("PERSISTED_PLAYER_MISSING",{playerId:t});if(!Ge(e.persisted[t]))throw Ke("PERSISTED_PLAYER_NOT_AN_OBJECT",{playerId:t});var r,n,i,o=(r=e.persisted[t],n=100,{size:i=(JSON.stringify(r)||"").length,underLimit:i<1024*n});if(!o.underLimit)throw Ke("PERSISTED_PLAYER_OVER_LIMIT",{playerId:t,limit:100,size:o.size})})),Object.keys(e.persisted).forEach((function(e){if(!t.includes(e))throw Ke("PERSISTED_EXTRA_KEY_DETECTED",{key:e})}))}var Je=function(e){globalThis.Math.__SDK_PRECISION_SET__||(p.forEach((function(e){var t,r;globalThis.Math[e]=(t=globalThis.Math,r=globalThis.Math[e],function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.fround(r.apply(t,e))})})),globalThis.Math.__SDK_PRECISION_SET__=!0);var t={setup:void 0,actions:void 0,events:void 0,logicContext:{msPerTick:0,logicTick:0,randomSeed:0},gameOverContext:null,initLogic:function(i){var o,a,l;if(!i)throw new Error("initParams are required");"runtime"!==e&&function(e){if(e.minPlayers<1)throw new Error("minPlayers cannot be lower than 1");if(e.maxPlayers>6)throw new Error("maxPlayers cannot be greater than ".concat(6));if(e.maxPlayers<e.minPlayers)throw new Error("minPlayers cannot be greater than maxPlayers");if(void 0!==e.updatesPerSecond&&("number"!=typeof e.updatesPerSecond||e.updatesPerSecond<1||e.updatesPerSecond>30||!Number.isInteger(e.updatesPerSecond)))throw new Error("updatesPerSecond must be either not defined or a number between 1 & ".concat(30))}(i),t.gameConfig={minPlayers:i.minPlayers,maxPlayers:i.maxPlayers,eventCallbacks:{playerJoined:!!(null===(o=i.events)||void 0===o?void 0:o.playerJoined),playerLeft:!!(null===(a=i.events)||void 0===a?void 0:a.playerLeft)},update:!!i.update,updatesPerSecond:i.updatesPerSecond||1,landscape:null!==(l=i.landscape)&&void 0!==l&&l,persistPlayerData:i.persistPlayerData||!1,reactive:void 0===i.reactive||i.reactive},t.setup=function(n){var o=n.roomId,a=n.logicContext,s=n.playerIds,u=n.calculateStateHash,l=n.persistedPlayers;return r(a,(function(){var r,n,a,c,f=(null===(r=t.gameConfig)||void 0===r?void 0:r.persistPlayerData)&&null!==l;f?(a={persisted:l},s.forEach((function(e){a.persisted[e]||(a.persisted[e]={})}))):a={};var p=we(a,(function(e){var t;c=null!==(t=i.setup(s,f?{game:e}:void 0))&&void 0!==t?t:{}}),t.gameConfig.reactive);if("runtime"!==e){if(c.persisted)throw Ke("SETUP_PERSISTED_KEY_NOT_ALLOWED");(null===(n=t.gameConfig)||void 0===n?void 0:n.persistPlayerData)&&p.persisted!==a.persisted&&He(p,s)}var d=we(c||{},(function(e){var r;(null===(r=t.gameConfig)||void 0===r?void 0:r.persistPlayerData)&&(e.persisted=p.persisted)}),t.gameConfig.reactive);if(y(o,d),t.gameOverContext)throw Ke("SETUP_GAME_OVER_NOT_ALLOWED");return{gameState:d,stateHash:u?We(d):void 0}}))},t.actions=Object.fromEntries(Object.entries(i.actions||{}).map((function(e){var r=u(e,2),i=r[0],o=r[1];return[i,function(e){var r,i=e.roomId,a=e.logicContext,u=e.params,l=e.actionContext,c=e.calculateStateHash;return n(i,a,(function(e){o(u,s(s({},l),{game:e}))}),l.allPlayerIds,c,!0,(null===(r=t.gameConfig)||void 0===r?void 0:r.persistPlayerData)||!1)}]}))),t.events={playerJoined:function(e){var r,o,a=e.roomId,u=e.logicContext,l=e.playerId,c=e.persistedPlayerState,f=e.eventContext,p=e.calculateStateHash,d=v(a);(null===(r=t.gameConfig)||void 0===r?void 0:r.persistPlayerData)&&null!==c&&y(a,we(d,(function(e){e.persisted[l]=c}),t.gameConfig.reactive));return n(a,u,(function(e){var t,r;null===(r=null===(t=i.events)||void 0===t?void 0:t.playerJoined)||void 0===r||r.call(t,l,s(s({},f),{game:e}))}),f.allPlayerIds,p,!1,(null===(o=t.gameConfig)||void 0===o?void 0:o.persistPlayerData)||!1)},playerLeft:function(e){var r,o,a,u,l=e.roomId,c=e.logicContext,f=e.playerId,p=e.eventContext,d=e.calculateStateHash,h=v(l);(null===(o=t.gameConfig)||void 0===o?void 0:o.persistPlayerData)&&y(l,we(h,(function(e){delete e.persisted[f]}),t.gameConfig.reactive));var g=n(l,c,(function(e){var t,r;null===(r=null===(t=i.events)||void 0===t?void 0:t.playerLeft)||void 0===r||r.call(t,f,s(s({},p),{game:e}))}),p.allPlayerIds,d,!1,(null===(a=t.gameConfig)||void 0===a?void 0:a.persistPlayerData)||!1);return"data"in g?{data:s(s({},g.data),{persistedPlayers:(null===(u=t.gameConfig)||void 0===u?void 0:u.persistPlayerData)?(r={},r[f]=h.persisted[f],r):null})}:g}},i.update?t.update=function(e){var r,o=e.roomId,a=e.logicContext,u=e.updateContext;return n(o,a,(function(e){var t;null===(t=i.update)||void 0===t||t.call(i,s(s({},u),{game:e}))}),u.allPlayerIds,!1,!1,(null===(r=t.gameConfig)||void 0===r?void 0:r.persistPlayerData)||!1)}:delete t.update},invalidAction:function(){return(e=new Error("".concat("Dusk",".invalidAction() was called"))).name=f,e;var e},gameOver:function(e){t.gameOverContext={reason:"gameEnded",options:c(e),players:{}}},gameTime:function(){var e,r,n,i;return n=null!==(e=t.logicContext.logicTick)&&void 0!==e?e:0,i=null!==(r=t.logicContext.msPerTick)&&void 0!==r?r:0,n*i},gameTimeInSeconds:function(){return e=t.gameTime(),Math.floor(e/1e3);var e},runAction:function(e){for(var r,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return(r=t.actions)[e].apply(r,l([],u(n),!1))},runPlayerJoinedEvent:function(){for(var e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(e=t.events).playerJoined.apply(e,l([],u(r),!1))},runPlayerLeftEvent:function(){for(var e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(e=t.events).playerLeft.apply(e,l([],u(r),!1))},rehydrate:function(e,t){y(e,t)},getActionNames:function(){return t.actions?Object.keys(t.actions):[]},getGameState:function(e,t){try{var r=v(e);return{data:{gameState:v(e),stateHash:t?We(r):void 0}}}catch(e){if("[GAMES_SDK][ROOM_GAME_STATE_MISSING]"===e.message)return{error:e.message};throw e}},cleanup:function(e){g(e)},getPersistedData:function(e,r){var n;if(!(null===(n=t.gameConfig)||void 0===n?void 0:n.persistPlayerData))throw Ke("PERSISTED_STATE_NOT_ENABLED");var i=t.getGameState(e,!1);if("error"in i)return i;var o=i.data.gameState.persisted;if(!r)return{data:{persistedPlayers:o}};var a={};return r.forEach((function(e){a[e]=o[e]})),{data:{persistedPlayers:a}}}};function r(e,r){return t.gameOverContext=null,t.logicContext=e,Oe(t.logicContext.randomSeed,r)}function n(n,i,o,a,s,u,l){return r(i,(function(){try{var r=v(n),i=we(r,o,t.gameConfig.reactive);if("runtime"!==e){if(!l&&i.persisted)throw Ke("PERSISTED_STATE_USED_WITHOUT_FLAG");r.persisted!==i.persisted&&He(i,a)}return y(n,i),{data:{gameContext:{gameOver:t.gameOverContext},stateHash:s?We(i):void 0}}}catch(e){if(u&&(function(e){return"object"==typeof e&&null!==e&&"name"in e}(c=e)&&("RUNE_INVALID_ACTION"===c.name||"DUSK_INVALID_ACTION"===c.name)))return{data:!1};if("[GAMES_SDK][ROOM_GAME_STATE_MISSING]"===e.message)return{error:e.message};throw g(n),e}var c}))}return t}("runtime");globalThis.Rune=Je,globalThis.Dusk=Je}();
